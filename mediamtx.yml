###############################################
# MediaMTX Configuration - Local RTMP Relay
###############################################

# Global settings
logLevel: info
logDestinations: [stdout]

# API settings
api: yes
apiAddress: 127.0.0.1:9997

# RTMP server settings
rtmp: yes
rtmpAddress: :1935
rtmpEncryption: no

# Recording settings (for buffering)
recordingsEnabled: yes
recordingsPath: /recordings
recordingsFormat: fmp4
recordingsPartDuration: 2s
recordingsSegmentDuration: 10s

# HLS settings (for internal buffering)
hls: yes
hlsAddress: :8888
hlsEncryption: no
hlsDirectory: /hls
hlsSegmentCount: 6
hlsSegmentDuration: 2s

# Paths configuration
paths:
  # Local relay path - receives from our encoder
  live_relay:
    runOnReady: echo "Stream ready on relay"
    runOnReadyRestart: yes
    source: publisher
    fallback: publisher
    
  # Publishing paths - pushes to external RTMP
  publish_primary:
    runOnReady: echo "Publishing to primary"
    runOnReadyRestart: yes
    source: publisher
    
  publish_backup:
    runOnReady: echo "Publishing to backup"  
    runOnReadyRestart: yes
    source: publisher

# Performance settings
readTimeout: 10s
writeTimeout: 10s
udpMaxPayloadSize: 1472